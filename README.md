# クラスメソッド社 課題2

```text
■課題2 (説明：15〜20分、質疑応答：30〜40分)
『AWSアーキテクチャ設計試験の概要』
Webシステム（ECサイト）のリニューアル案件（要件は後述）で、
AWS環境でのシステム構築を検討しているお客様を想定して、
構成及び運用を検討し、発表してください。

・回答していただく内容
　 必須：システム構成図(全体構成がわかれば体裁は問いません)の
　　　　 提示とその発表、質疑応答
　 オプション：ミドルウェア構成、ネットワーク構成、要件に対する
　　　　 解決策の提案、セキュリティ設計・運用（資料作成は任意）
　 不要：キャパシティプランニング（台数やスペックの確定）、構
　　　　 築や運用の体制、金額見積り

・注意事項など
　 - 満点回答が存在する試験ではありません。
　 - 要件で不明な点がある場合は、自分で想定して構成を作成して
　　 下さい。また考えた想定は当日ご回答ください。
　 - ディスカッション通じて、得意なスキルやアーキテクチャに対
　　 する考え方をアピールしてください。

・Webシステム（ECサイト）の構成
　 ECサイトの背景
　 お客様はアパレルのECサイトを運営している。現在、ECサイト
　 の大幅リニューアルを進めている。
　 お客様がECサイトの新アプリケーションを作成しているが、動
　 作させるインフラ構成が決まっていない。
　 新サイトオープンまでの間に、ある程度はアプリケーションの改
　 修はできる。
　 新サイトオープンまで1ヶ月で、オープンした1週間後にテレビ取
　 材がある。
　 新サイトオープン後のテレビ取材でビジネスを一気に広げたい。
　 クラウド移行に合わせて現状のレガシーな運用を減らし、代わりに
　 クラウドらしいセキュリティ運用を段階的に始めたい。

・アーキテクチャ設計要件
　 機能要件
　 - 既存会員数は100万人。
　 - 販売アイテム数は5,000点。季節ごとに1,000点を入れ替える。
　 - 販売アイテムはキーワード検索を行いたい。
　 - サブシステムとして、エンドユーザが利用する公開サイト、運
　　 営社が利用する管理サイト、集計バッチサーバの3個に別れる。
　 - エンドユーザはログインしなくてもアイテムの検索/参照/カート
　　 入れはできる。カートの内容を購入するときにはログインが必
　　 須になる。
　 - 料金支払いでは、外部の決済代行業者を使用してクレジットカ
　　 ード決済を行う。
　 - 会員登録では、最初にメールアドレスを登録する。メール送信
　　 をして、メール中のリンクから会員情報を登録してもらう。

・補足
　 曖昧になっている箇所もあるかと思いますが、そのあたりは
　 推測・仮説で決めていただいて構いません。
```

## メモ

```text
・Webシステム（ECサイト）の構成
　 ECサイトの背景
　 お客様はアパレルのECサイトを運営している。現在、ECサイト
　 の大幅リニューアルを進めている。
　 お客様がECサイトの新アプリケーションを作成しているが、動
　 作させるインフラ構成が決まっていない。
　   🎉 CloudFront + S3で静的コンテンツ配信
　   🎉 ALB + ECS(Fargate)でアプリケーション配信
　   🎉 RDS(Aurora)でデータベース
　 新サイトオープンまでの間に、ある程度はアプリケーションの改
　 修はできる。
　 新サイトオープンまで1ヶ月で、オープンした1週間後にテレビ取
　 材がある。
　   🎉 スケジュールされたAuto Scalingポリシー
　   🎉 通常はターゲット追跡型のAuto Scalingポリシーを使用
　 新サイトオープン後のテレビ取材でビジネスを一気に広げたい。
　   🎉 マルチサイト(アクティブ/アクティブ)
　   🎉 DNSでレイテンシベースのルーティングを行う
　 クラウド移行に合わせて現状のレガシーな運用を減らし、代わりにクラウドらしいセキュリティ運用を段階的に始めたい。
　   🎉 AWS WAFの導入
　   🎉 AWS Firewall ManagerによるWAF一元管理
　   🎉 AWS Shieldの導入
　   🎉 GuardDutyの導入
　   🎉 AWS IAM Access Analyzerの導入
　   🎉 AWS Macieによる機密データの検出
　   🎉 AWS Security Hubの有効化
　   🎉 CloudWatchの導入
　   🎉 ログはCloudWatch Logsに保存
　   🎉 CloudWatch Logs Filterを用いて、機密情報はログから除外
　   🎉 AWS Backup を使用した定期的なバックアップ
　   🎉 Secrets Managerを用いて、DBの認証情報を管理
　   🎉 ACMを用いて、サイトのSSL証明書を管理
　   🎉 Route 53のDNSフェイルオーバー設定
　   🎉 AWS Budgetsによるコスト監視
　   🎉 AWS Health Dashboardの監視
　   🎉 RDSはメンテナンスウィンドウを設定して、メンテナンスを行う
　   🎉 RDSへの接続は特定のセキュリティグループ・サブネットからのみに制限
　   🎉 RDS Proxyを用いて、RDSへの接続を管理
　   🎉 ECRのリポジトリイメージスキャンを行うことで、コンテナイメージの脆弱性を管理
　   🎉 ECRのイメージは定期的に別のリージョンにコピーする
　   🎉 ECRイメージのプルはVPCエンドポイントを経由する
　   🎉 S3のバージョニングを有効化して、誤った削除からの保護
　   🎉 S3のバケットポリシーを設定して、バケットへの不正アクセスからの保護
　   🎉 S3の暗号化を有効化して、データの保護

・アーキテクチャ設計要件
　 機能要件
　 - 既存会員数は100万人。
　 - 販売アイテム数は5,000点。季節ごとに1,000点を入れ替える。
　 - 販売アイテムはキーワード検索を行いたい。
　   🎉 Auroraリードレプリカを用いたデータベースの読み取り専用化
　   🎉 Auto Scalingを用いたリードレプリカのスケーリング
　 - サブシステムとして、エンドユーザが利用する公開サイト、運営社が利用する管理サイト、集計バッチサーバの3個に別れる。
　   🎉 バッチサーバはStep Functions+Lambdaで管理
　   🎉 集計されたデータはS3に保存して、Athenaで分析
　 - エンドユーザはログインしなくてもアイテムの検索/参照/カート入れはできる。カートの内容を購入するときはログインが必須になる。
　   🎉 ユーザー認証はCognitoで管理
　   🎉 IDプールを用いて一時的な認証情報を発行し、カート情報をDynamoDBで管理
　 - 料金支払いでは、外部の決済代行業者を使用してクレジットカード決済を行う。
　   🎉 クレジットカード情報の非保持化 (PCI DSSに準拠するため)
　 - 会員登録では、最初にメールアドレスを登録する。メール送信をして、メール中のリンクから会員情報を登録してもらう。
　   🎉 メール送信はSESで管理
